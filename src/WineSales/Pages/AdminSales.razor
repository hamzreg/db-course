@page "/adminSales"

@using WineSales.Domain.Interactors

@inject IUserInteractor UserInteractor
@inject ISaleInteractor SaleInteractor

@if (nowUser.Role != "admin")
{
    <Jumbotron Background="Background.Light" Margin="Margin.Is4.FromBottom">
        <JumbotronSubtitle>
            Для просмотра этой страницы необходимо войти в аккаунт администратора.
        </JumbotronSubtitle>
    </Jumbotron>
}
else
{
    <Jumbotron Background="Background.Light" Margin="Margin.Is4.FromBottom">
        <JumbotronTitle Size="JumbotronTitleSize.Is4">Продажи</JumbotronTitle>
        <Divider></Divider>
    </Jumbotron>

    <Table>
        <TableHeader>
            <TableRow>
                <TableHeaderCell>Сорт</TableHeaderCell>
                <TableHeaderCell>Цвет</TableHeaderCell>
                <TableHeaderCell>Объем (л)</TableHeaderCell>
                <TableHeaderCell>Сахар</TableHeaderCell>
                <TableHeaderCell>Алкоголь (%)</TableHeaderCell>
                <TableHeaderCell>Выдержка (лет)</TableHeaderCell>
                <TableHeaderCell>Поставщик</TableHeaderCell>
                <TableHeaderCell>Дата</TableHeaderCell>
                <TableHeaderCell>Количество</TableHeaderCell>
                <TableHeaderCell>Цена поставки (₽)</TableHeaderCell>
                <TableHeaderCell>Цена реализации (₽)</TableHeaderCell>
                <TableHeaderCell>Издержки (₽)</TableHeaderCell>
                <TableHeaderCell>Прибыль (₽)</TableHeaderCell>
            </TableRow>
        </TableHeader>
        <TableBody>
            @for (int i = 0; i < wines.Count; i++)
            {
                <OneAdminSale OneWine="wines[i]" SupplierName=@suppliers[i] OneSale="sales[i]"></OneAdminSale>
            }
        </TableBody>
    </Table>
}

@code {
    private List<Wine> wines = new List<Wine>();
    private List<string> suppliers = new List<string>();
    private List<Sale> sales = new List<Sale>();

    private User nowUser;

    protected override void OnInitialized()
    {
        nowUser = UserInteractor.GetNowUser();
        (wines, suppliers, sales) = SaleInteractor.GetByAdmin();

        base.OnInitialized();
    }
}
